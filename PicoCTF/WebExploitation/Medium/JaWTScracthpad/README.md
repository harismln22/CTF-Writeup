# Judul
JaWT Scratchpad

# Deskripsi
Author: John Hammond

    Internal server errors can be intentionally returned by this challenge. If you experience one, try clearing your cookies.
    
Check the admin scratchpad! https://jupiter.challenges.picoctf.org/problem/63090/ or http://jupiter.challenges.picoctf.org:63090

masalah: memanipulasi token/cookie jwt menjadi admin

vurnerability: JWT token

# Langkah
1. Masuk ke link tersebut dengan copy httpsnya lalu paste ke url

![awal page](https://github.com/user-attachments/assets/4e40a275-cda4-4d07-8959-5e58d273d771)

2. yang bisa di interaksi hanya kolom putih tersebut untuk register masuk ke aplikasinya (terdapat petunjuk kalau jawt ini adalah jwt dan juga terdapat nama john yang berarti johntheripper)
3. Kita juga mengetahui kalau nama admin untuk aplikasi ini adalah 'admin', karena disana bertuliskan admin itu mempunyai spesial scratchpad.
4. register dengan nama yang kalian inginkan dengan mengisi kolom tersebut lalu klik enter

![page 2](https://github.com/user-attachments/assets/b65ee587-abf0-4ec0-b372-465712eb7013)


5. hanya terdapat kolom untuk menyimpan seperti note dan juga logout, karena kita dapet petunjuk kalau ini jwt, kita cek cookie jwt dengan klik kanan lalu klik inspect dan cari storage.

![jwt token 1](https://github.com/user-attachments/assets/3b353079-63aa-4bcf-bc32-dfa0c8e7093e)

6. Buka https://jwt.io/ di tab baru, lalu paste bagian encode.

![jwt web 2](https://github.com/user-attachments/assets/0b35bceb-d583-43c8-844a-020b5f812ce8)


    * Dalam bagian decode terdapat 3 bagian: Header, payload, signature
        - Header: untuk menunjukan tipe token apa dan algoritma keamanan apa dalam token tersebut
        - Payload: mengisi atau mengubah data seperti kita bisa mengubah nama user tersebut
        - signature: ini adalah seperti tanda tangan dari token tersebut, dan ini hanya terdapat pada token yang memiliki keamanan.

7. Karena algoritma ini adalah HS256, berarti kita butuh signature dan tidak hanya mengubah nama user tersebut menjadi admin.
8. Copy value cookie jwt dan simpan di folder dengan nama file jwt_hash.txt
9. Karena tadi sudah mendapatkan petunjuk tentang john, berarti kita harus mengcrack hash ini dengan john. caranya:

        john jwt_hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=HMAC-SHA256
          - jwt_hash.txt: ini adalah file hash jwt yang kalian simpan
          - --wordlist: ini path kalian untuk dictionary, jika belum punya rockyou.txt bisa download di internet
          - --format: cara format john untuk hash tersebut
10. setelah menunggu nanti ada hasil dari hash signature tersebut

![john jwt](https://github.com/user-attachments/assets/c4669aee-dc49-41c1-8f3c-f3273938b4d9)

11. signature tersebut bernama **ilovepico** , balik lagi ke halaman decoder jwt tadi dan masukkan **ilovepico** ke kolom signature dan mengubah nama user menjadi admin

![decoderr](https://github.com/user-attachments/assets/f1b36396-d527-44c5-bc1d-2b68a028dc9a)

12. Setelah mengubah payload dan signature, copy encoder tersebut dan paste ke cookie jwt di page ctf tadi.
13. sesudah memasukan cookie jwt baru, lalu refresh dan flag akan muncul (jika tidak, liat ke inspect dan cari di bagian body)

![hasil](https://github.com/user-attachments/assets/082e96e7-621a-4a10-b778-bcb4fd1b1a86)

 
