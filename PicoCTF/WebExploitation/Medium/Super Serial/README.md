# Judul
Super Serial

# Deskripsi
Author: madStacks

Try to recover the flag stored on this website http://mercury.picoctf.net:25395/

Masalah: Mendapatkan flag dari website

Vurnerability: Path Traversal / Deserialization 

# Langkah
1. Masuk ke linknya
2. Terdapat tampilan login dari username dan password

![awal page](https://github.com/user-attachments/assets/bc050396-ee5d-4ad6-9103-24782045cf59)

3. Dalam php, terkadang kalau kita menambahkan s di phpnya kita bisa melihat source code dari page tersebut. Kita coba index.phps

![index phps](https://github.com/user-attachments/assets/4313a538-8ab0-4c9f-9a18-d0ab38ac101d)

4. terdapat petunjuk untuk kalau user itu login sebagai guest atau admin, maka akan set cookie login dengan di encode base64.
5. Sekarang coba ke authentication.php

![authen php](https://github.com/user-attachments/assets/192f59de-d32d-402c-acae-64fb5d25a2aa)

6. Langsung otomatis sebagai guest.. dan cookienya juga tidak didapatkan karena kita tidak masuk secara login.
7. seperti tadi, cek authentication.phps

![authen phps](https://github.com/user-attachments/assets/209531a8-83b9-4dbf-96af-8f19aab5aac6)

8. class access_log, dari nama dengan fungsi fungsi yang tersedia. Kita tahu kalau ini adalah class untuk membaca file log
10. Karena terdapat require cookie.php, kita cek juga dengan tambahan s untuk dibelakangnya

![cookie phps](https://github.com/user-attachments/assets/c72e6e02-5643-466c-a12a-15017f043137)

11. di cookie ini terdapat kelas permission.. dan juga fungsi jika yang login itu sebagai guest atau admin.. (dan ini tidak bisa di inject sql karena inputnya sudah disanitasi)
12. tetapi bagian menariknya disini

![login phps](https://github.com/user-attachments/assets/aaa50048-489c-42ac-8aa5-ea5565589eda)

13. Terdapat syntax unserialized untuk cookie bernama login dengan encode base64, Kita bisa manfaatkan disini (https://portswigger.net/web-security/deserialization/exploiting)

14. Pertama kita ambil dari nama kelas access_log dengan cara:

        - O:10, ini untuk mengambil object (nama kelas) dengan berapa huruf. Jadinya O:10:"access_log"
        - :1: , ini menunjukkan kalau kelas tersebut hanya mempunyai satu properti
        - s:8: , s adalah string dan 8 itu panjang nama variabel tersebut. Jadinya s:8:"log_file"
        - s:7 , sama seperti tadi. Jadinya s:7:"../flag". maksud dari /flag adalag path traversal dimana penyerang bisa akses diluar konten dari websitenya
16. Jika digabungkan, menjadi O:10:"access_log":1:{s:8:"log_file";s:7:"../flag";}
17. masuk ke https://gchq.github.io/CyberChef/ lalu tambahkan dengan encode "To Base64"
18. setelah kalian encode, kalian akan mendapatkan outputnya
19. lalu sekarang kalian balik ke ctfnya, buka inspect lalu storage dan cookie. Klik tambah + lalu ubah nama menjadi login dan masukan value dari encode kalian tadi lalu refresh.

![cookiess](https://github.com/user-attachments/assets/2881f32c-bb24-4833-acf6-92edd706a008)

Hasilnya:






